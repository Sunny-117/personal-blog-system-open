(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52588a7a"],{"084e":function(t,e,a){},"09f7":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("Layout",{scopedSlots:t._u([{key:"right",fn:function(){return[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"right-container"},[t.data?e("BlogTOC",{attrs:{toc:t.data.toc}}):t._e()],1)]},proxy:!0}])},[[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"mainContainer",staticClass:"main-container"},[t.data?e("BlogDeail",{attrs:{blog:t.data}}):t._e(),t.isLoading?t._e():e("BlogComment")],1)]],2)},n=[],i=(a("d22b"),a("5849")),o=function(){var t=this,e=t._self._c;return t.blog?e("div",{staticClass:"blog-detail-container"},[e("h1",[t._v(t._s(t.blog.title))]),e("div",{staticClass:"aside"},[e("span",[t._v("日期："+t._s(t.formatDate(t.blog.createDate)))]),e("span",[t._v("浏览："+t._s(t.blog.scanNumber))]),e("a",{attrs:{href:"#form-data-container"}},[t._v("评论："+t._s(t.blog.commentNumber))]),e("router-link",{attrs:{to:{name:"blogCategory",params:{categoryId:t.blog.category.id}}}},[t._v(t._s(t.blog.category.name))])],1),e("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.blog.htmlContent)}})]):t._e()},r=[],c=a("2095"),l=(a("db6a"),{props:{blog:{type:Object,required:!0}},methods:{formatDate:c["a"]}}),d=l,u=(a("22b0"),a("de1f")),h=Object(u["a"])(d,o,r,!1,null,"5f1d778c",null),f=h.exports,m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-toc-container"},[e("h1",[t._v("目录")]),t.toc?e("RightList",{attrs:{list:t.toWithSelect},on:{selected:t.handleSelected}}):t._e()],1)},g=[],p=a("b42c"),v=a("20ca"),b={props:{toc:{type:Array,required:!0}},components:{RightList:p["a"]},data(){return{activeAnchor:""}},computed:{toWithSelect(){const t=(e=[])=>e.map(e=>({...e,isSelected:e.anchor==this.activeAnchor,children:t(e.children)}));return t(this.toc)},getDoms(){const t=[],e=a=>{for(const s of a){const a=document.getElementById(s.anchor);t.push(a),s.children&&e(s.children)}};return e(this.toc),t}},methods:{debounce:v["a"],handleSelected(t){location.hash=t.anchor},setSelect(t){if(!t)return;if(0==t.scrollTop)return void(this.activeAnchor="");const e=120;for(const a of this.getDoms){const t=a.getBoundingClientRect().top;if(t>e)return;this.activeAnchor=a.id}}},created(){this.setSelects=this.debounce(this.setSelect,50),this.$eventBus.$on("mainScroll",this.setSelects)},destroyed(){this.$eventBus.$off("mainScroll",this.setSelects)}},_=b,S=(a("47bf"),Object(u["a"])(_,m,g,!1,null,"0247e2bd",null)),D=S.exports,C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-comment-container"},[e("MessageArea",{attrs:{title:"评论列表",subTitle:`(${t.data.total})`,list:t.data.rows,isListLoading:t.isLoading},on:{clicks:t.handleClicks}})],1)},$=[],y=a("684a"),k=a("e128"),L=a("4196"),w=a("864d"),x={mixins:[Object(k["a"])({total:0,rows:[]}),Object(L["a"])()],components:{MessageArea:y["a"]},methods:{async fetchData(){const t=await Object(w["d"])(this.$route.params.id,this.page,this.limit);return t},async handleClicks(t,e){const a=await Object(w["e"])({blogId:this.$route.params.id,...t});this.data.rows.unshift(a),this.data.total++,e("评论成功")}}},O=x,B=(a("23da"),Object(u["a"])(O,C,$,!1,null,"3738cca9",null)),j=B.exports,M=a("f119"),A=a("5ec4"),T={mixins:[Object(k["a"])(),Object(M["a"])("mainContainer")],components:{Layout:i["a"],BlogDeail:f,BlogTOC:D,BlogComment:j},methods:{async fetchData(){let t=await Object(w["a"])(this.$route.params.id);if(t)return t.title&&A["a"].setRoute(t.title),t;this.$router.push("/NotFound")}},updated(){const t=location.hash;location.hash="",setTimeout(()=>{location.hash=t},50)}},N=T,R=(a("ba41"),Object(u["a"])(N,s,n,!1,null,"6388a46c",null));e["default"]=R.exports},2095:function(t,e,a){"use strict";e["a"]=function(t,e=!1){const a=new Date(+t);let s=a.getMonth()+1;s<10&&(s="0"+s);let n=a.getDate();if(n<10&&(n="0"+n),e){let t=a.getHours().toString().padStart(2,"0"),e=a.getMinutes().toString().padStart(2,"0"),i=a.getSeconds().toString().padStart(2,"0");return`${a.getFullYear()}-${s}-${n} ${t}:${e}:${i}`}return`${a.getFullYear()}-${s}-${n}`}},"22b0":function(t,e,a){"use strict";a("33cb")},"23da":function(t,e,a){"use strict";a("084e")},"33cb":function(t,e,a){},"3b3e":function(t,e,a){},"416c":function(t,e,a){},4196:function(t,e,a){"use strict";e["a"]=function(){return{data(){return{page:1,limit:10}},created(){this.$eventBus.$on("mainScroll",this.handleScrolls)},destroyed(){this.$eventBus.$off("mainScroll",this.handleScrolls)},computed:{hasMore(){return this.data.rows.length<this.data.total}},methods:{async fetchMoreData(){if(!this.hasMore)return;this.isLoading=!0,this.page++;const t=await this.fetchData();this.isLoading=!1,this.data.total=t.total,this.data.rows=this.data.rows.concat(t.rows)},handleScrolls(t){if(this.isLoading||!t)return;const e=100,a=t.scrollHeight-t.clientHeight-t.scrollTop;a<e&&this.fetchMoreData()}}}}},"42f0":function(t,e,a){"use strict";a("c01f")},"47bf":function(t,e,a){"use strict";a("416c")},"4ec2":function(t,e,a){"use strict";a("3b3e")},"684a":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"message-area-container"},[e("FormData",t._g({},t.$listeners)),e("h4",[t._v(t._s(t.title)),e("span",[t._v(t._s(t.subTitle))])]),e("DataList",{attrs:{list:t.list}}),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isListLoading,expression:"isListLoading"}],staticClass:"loading"})],1)},n=[],i=function(){var t=this,e=t._self._c;return e("div",{ref:"form",attrs:{id:"form-data-container"}},[e("form",{staticClass:"form-data"},[e("div",{staticClass:"input-area"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.nickname,expression:"formData.nickname"}],attrs:{maxlength:"10",type:"text",placeholder:"用户昵称"},domProps:{value:t.formData.nickname},on:{input:function(e){e.target.composing||t.$set(t.formData,"nickname",e.target.value)}}}),e("div",{staticClass:"name-err"},[t._v(t._s(t.errorData.nickname))]),e("span",[t._v(t._s(t.formData.nickname.length)+"/10")])]),e("div",{staticClass:"comment-area"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],attrs:{maxlength:"300",placeholder:"输入内容"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),e("div",{staticClass:"content-err"},[t._v(t._s(t.errorData.content))]),e("span",[t._v(t._s(t.formData.content.length)+"/300")])]),e("button",{staticClass:"submit",attrs:{disabled:t.isSubmiting},on:{click:function(e){return e.preventDefault(),t.handleClick.apply(null,arguments)}}},[t._v(t._s(t.isSubmiting?"提交中...":"提交"))])])])},o=[],r=a("c4f5"),c={data(){return{formData:{nickname:"",content:""},errorData:{nickname:"",content:""},isSubmiting:!1}},methods:{showMessage:r["a"],handleClick(){this.errorData.nickname=this.formData.nickname?"":"请输入昵称！",this.errorData.content=this.formData.content?"":"请输入内容！",this.errorData.nickname||this.errorData.content||(this.isSubmiting=!0,this.$emit("clicks",this.formData,t=>{this.formData.nickname="",this.formData.content="",this.isSubmiting=!1,this.showMessage({content:t,type:"success",container:this.$refs.form,duration:800})}))}}},l=c,d=(a("4ec2"),a("de1f")),u=Object(d["a"])(l,i,o,!1,null,"6dc72968",null),h=u.exports,f=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"form-list-container"},t._l(t.list,(function(a,s){return e("li",{key:s},[e("Avatar",{attrs:{url:a.avatar,size:44}}),e("div",{staticClass:"message"},[e("span",{staticClass:"nick-name"},[t._v(t._s(a.nickname))]),e("p",{staticClass:"comment-content"},[t._v(" "+t._s(a.content)+" ")]),e("div",{staticClass:"date"},[e("span",[t._v(t._s(t.formatDate(a.createDate,!0)))])])])],1)})),0)},m=[],g=a("77c0"),p=a("2095"),v={components:{Avatar:g["a"]},props:{list:{type:Array,default:()=>[]}},methods:{formatDate:p["a"]}},b=v,_=(a("a024"),Object(d["a"])(b,f,m,!1,null,"e40b4dce",null)),S=_.exports,D={components:{FormData:h,DataList:S},props:{title:{type:String,default:""},subTitle:{type:String,default:""},list:{type:Array,default:()=>[]},isListLoading:{type:Boolean,default:!1}}},C=D,$=(a("42f0"),Object(d["a"])(C,s,n,!1,null,"1aab5cb8",null));e["a"]=$.exports},"85e3":function(t,e,a){},"92a5":function(t,e,a){},"9aef":function(t,e,a){"use strict";a("92a5")},a024:function(t,e,a){"use strict";a("85e3")},b42c:function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"right-list-container"},t._l(t.list,(function(a,s){return e("li",{key:s},[e("span",{class:{isSelected:a.isSelected},on:{click:function(e){return t.handleClick(a)}}},[t._v(" "+t._s(a.name)+" ")]),e("span",{staticClass:"articleCount",class:{isSelected:a.isSelected}},[t._v(t._s(a.articleCount))]),a.children?e("RightList",{attrs:{list:a.children},on:{selected:t.handleClick}}):t._e()],1)})),0)},n=[],i={name:"RightList",props:{list:{type:Array,default:()=>[]}},methods:{handleClick(t){t.isSelected||this.$emit("selected",t)}}},o=i,r=(a("9aef"),a("de1f")),c=Object(r["a"])(o,s,n,!1,null,"47a0e164",null);e["a"]=c.exports},ba41:function(t,e,a){"use strict";a("df85")},c01f:function(t,e,a){},db6a:function(t,e,a){},df85:function(t,e,a){},e128:function(t,e,a){"use strict";e["a"]=function(t=null){return{data(){return{isLoading:!0,data:t}},async created(){this.data=await this.fetchData(),this.isLoading=!1}}}},f119:function(t,e,a){"use strict";e["a"]=function(t){return{mounted(){this.$eventBus.$on("setMainScroll",this.handleSetMainScroll),this.$refs[t].addEventListener("scroll",this.handleScroll)},beforeDestroy(){this.$eventBus.$emit("mainScroll"),this.$eventBus.$off("setMainScroll",this.handleSetMainScroll),this.$refs[t].removeEventListener("scroll",this.handleScroll)},methods:{handleScroll(){this.$eventBus.$emit("mainScroll",this.$refs[t])},handleSetMainScroll(e){this.$refs[t].scrollTop=e}}}}}}]);
//# sourceMappingURL=chunk-52588a7a.2863a929.js.map